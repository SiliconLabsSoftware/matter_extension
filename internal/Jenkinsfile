pipeline {
    agent any
    stages {
        stage('Trigger downstream') {
            steps {
                script {
                    // Trigger New PR workflow comment again
                    // TODO: Need to change branch to trigger main branch once testing is done
                    // build job: "Matter GitHub Jenkins/feature%2Fgithub_jenkins_integration", parameters:[string(name: 'branchName', value: env.BRANCH_NAME), string(name:'buildNumber', value: env.BUILD_NUMBER)], wait: false
                    checkout([$class: 'GitSCM',
                              branches: [[name: '*/feature/github_jenkins_integration']],
                              browser: [$class: 'StashBrowser', repoUrl: 'https://stash.silabs.com/projects/WMN_TOOLS/repos/matter_github_jenkins'],
                              userRemoteConfigs: [[url: 'https://stash.silabs.com/scm/wmn_tools/matter_github_jenkins.git']]
                    ])
                    def matter_github_jenkins_jenkinsFile = load 'Jenkinsfile'
                    matter_github_jenkins_jenkinsFile.run()
                }
            }
        }
    }
}