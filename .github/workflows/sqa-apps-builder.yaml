name: Build SQA apps

on:
  workflow_call:

jobs:
    build-lock-app:
        name: Build Lock App
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "lock-app"
            build-type: "custom-sqa"
            ncp-917-support: true
            ncp-wf200-support: true
            mg24-internal-support: false
            mgm24-internal-support: false
            mg26-internal-support: false
            mgm26-internal-support: false

    build-lighting-app:
        name: Build Lighting App
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "lighting-app"
            build-type: "custom-sqa"
            mg24-internal-support: false
            mgm24-internal-support: false
            mg26-internal-support: false
            mgm26-internal-support: false

    build-window-app:
        name: Build Window App
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "window-app"
            build-type: "custom-sqa"
            mg24-support: false
            mg24-internal-support: false
            mgm24-support: false
            mg26-support: false
            mg26-internal-support: false
            mgm26-internal-support: false
            wifi-soc-support: false
            sixg301-support: false

  #  build-dishwasher-app:
  #      name: Build Dishwasher App
  #      uses: ./.github/workflows/platform-builder.yaml
  #      with:
  #          example-app: "dishwasher-app"
  #          build-type: "custom-sqa"
  #          mg24-support: false
  #          mg24-internal-support: false
  #          mgm24-support: false
  #          mgm24-internal-support: false
  #          mg26-support: false
  #          mg26-internal-support: false
  #          mgm26-internal-support: false
  #          wifi-soc-support: false
  #          sixg301-support: false

    build-thermostat:
        name: Build Thermostat
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "thermostat"
            build-type: "custom-sqa"
            mg24-support: false
            mg24-internal-support: false
            mgm24-support: false
            mgm24-internal-support: false
            mg26-support: false
            mg26-internal-support: false
            mgm26-internal-support: false
            wifi-soc-support: false
            sixg301-support: false

    build-light-switch-app:
        name: Build Light Switch App
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "light-switch-app"
            build-type: "custom-sqa"
            mg24-internal-support: false
            mgm24-support: false
            mgm24-internal-support: false
            mg26-internal-support: false
            mgm26-internal-support: false

    build-multi-sensor-app:
        name: Build Multi Sensor App
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "multi-sensor-app"
            build-type: "custom-sqa"
            mg24-internal-support: false
            mgm24-support: false
            mgm24-internal-support: false
            mg26-support: false
            mg26-internal-support: false
            mgm26-internal-support: false
            wifi-soc-support: false
            sixg301-support: false

    build-zigbee-matter-light:
        name: Build Zigbee Matter Light
        uses: ./.github/workflows/platform-builder.yaml
        with:
            example-app: "zigbee-matter-light"
            build-type: "custom-sqa"
            mg24-support: false
            mg24-internal-support: false
            mgm24-support: false
            mgm24-internal-support: false
            # mg26-support: false ## Disabled unitl https://jira.silabs.com/browse/MULTIPROT-1799 is fixed
            mg26-internal-support: false
            mgm26-internal-support: false
            wifi-soc-support: false
            # sixg301-support: false ## Disabled unitl https://jira.silabs.com/browse/MULTIPROT-1799 is fixed

    build-closure-app:
      name: Build Closure App
      uses: ./.github/workflows/platform-builder.yaml
      with:
        example-app: "closure-app"
        build-type: "custom-sqa"
        mg24-internal-support: false
        mgm24-support: false
        mgm24-internal-support: false
        mg26-internal-support: false
        mgm26-internal-support: false

    build-platform-template:
      name: Build Platform App
      uses: ./.github/workflows/platform-builder.yaml
      with:
        example-app: "platform-template"
        build-type: "custom-sqa"
        mg24-internal-support: false
        mgm24-support: false
        mgm24-internal-support: false
        mg26-internal-support: false
        mgm26-internal-support: false

    merge-apps:
        name: Merge SQA App Artifacts
        runs-on: ubuntu-latest
        needs:
            - build-lock-app
            - build-lighting-app
            - build-window-app
            - build-dishwasher-app
            - build-thermostat
            - build-light-switch-app
            - build-multi-sensor-app
            ## Disabled unitl https://jira.silabs.com/browse/MULTIPROT-1799 is fixed
            # - build-zigbee-matter-light
            - build-closure-app
            - build-platform-template
        if: always()

        steps:
            - name: Merge artifacts
              uses: actions/upload-artifact/merge@v5
              with:
                  name: "sqa-artifacts"
                  delete-merged: true
                  pattern: "*-custom-sqa"